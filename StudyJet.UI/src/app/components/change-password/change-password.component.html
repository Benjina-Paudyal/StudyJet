<h3 class="text-success mb-3 text-center fw-bold">Change Password</h3>
<p class="text-center">Change your password here.</p>

<h3 class="text-success mb-3">Password</h3>
<form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()" novalidate>
  <!-- Current Password -->
  <div class="mb-3">
    <input type="password" id="currentPassword" class="mt-4 form-control" formControlName="CurrentPassword"
      placeholder="Enter current password"
      [ngClass]="{'is-invalid': changePasswordForm.get('CurrentPassword')?.invalid && changePasswordForm.get('CurrentPassword')?.touched}" />
    <div
      *ngIf="changePasswordForm.get('CurrentPassword')?.invalid && changePasswordForm.get('CurrentPassword')?.touched"
      class="invalid-feedback">
      <div *ngIf="changePasswordForm.get('CurrentPassword')?.errors?.['required']">Current password is required.</div>
    </div>
  </div>

  <!-- New Password -->
  <div class="mb-3">
    <input type="password" id="newPassword" class="form-control" formControlName="Password"
      placeholder="Enter new password"
      [ngClass]="{'is-invalid': changePasswordForm.get('Password')?.invalid && changePasswordForm.get('Password')?.touched}" />
    <div *ngIf="changePasswordForm.get('Password')?.invalid && changePasswordForm.get('Password')?.touched"
      class="invalid-feedback">
      <div *ngIf="changePasswordForm.get('Password')?.errors?.['required']">Password is required.</div>
      <div *ngIf="changePasswordForm.get('Password')?.errors?.['passwordStrength']">
        Password must be at least 8 characters long and contain an uppercase letter, lowercase letter, number, and
        special character.
      </div>
      <div *ngIf="changePasswordForm.get('Password')?.errors?.['samePassword']">
        New password cannot be the same as the current password.
      </div>
    </div>
  </div>

  <!-- Confirm New Password -->
  <div class="mb-3">
    <input type="password" id="retypeNewPassword" class="form-control" formControlName="ConfirmPassword"
      placeholder="Re-type new password"
      [ngClass]="{'is-invalid': changePasswordForm.get('ConfirmPassword')?.invalid && changePasswordForm.get('ConfirmPassword')?.touched}" />
    <div
      *ngIf="changePasswordForm.get('ConfirmPassword')?.invalid && changePasswordForm.get('ConfirmPassword')?.touched"
      class="invalid-feedback">
      <div *ngIf="changePasswordForm.get('ConfirmPassword')?.errors?.['required']">Please confirm your password.</div>
    </div>
  </div>

  <!-- Password Mismatch Error -->
  <div *ngIf="changePasswordForm.errors?.['mismatch'] && changePasswordForm.touched" class="alert alert-danger">
    Passwords do not match.
  </div>

  <!-- Same Password Error -->
  <div *ngIf="changePasswordForm.errors?.['samePassword'] && changePasswordForm.touched" class="alert alert-danger">
    New password must be different from the current password.
  </div>

  <button type="submit" class="mt-4 mb-3 btn btn-success w-100">
    Change Password
    <span *ngIf="loading" class="spinner-border spinner-border-sm ms-2"></span>
  </button>

  <!-- Success or Error Messages -->
  <div *ngIf="successMessage" class="alert alert-success mt-4">
    {{ successMessage }}
  </div>
  <div *ngIf="errorMessage" class="alert alert-danger mt-4">
    {{ errorMessage }}
  </div>
</form>